<UserControl x:Class="Echo.Views.ChatViewRegion.RecentChatListView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
             xmlns:local="clr-namespace:Echo.Views.ChatViewRegion"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             d:DesignHeight="450"
             d:DesignWidth="250"
             mc:Ignorable="d">
    <Grid>
        <ListView ItemsSource="{Binding Chats}" SelectedItem="{Binding SelectedChat, Mode=TwoWay}">
            <ListView.ItemTemplate>
                <DataTemplate>
                    <Grid Margin="5" HorizontalAlignment="Center">
                        <i:Interaction.Triggers>
                            <i:EventTrigger EventName="MouseLeftButtonUp">
                                <i:InvokeCommandAction Command="{Binding DataContext.OpenChatCommand, RelativeSource={RelativeSource AncestorType=ListView}}" CommandParameter="{Binding}" />
                            </i:EventTrigger>
                        </i:Interaction.Triggers>

                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="50" />
                            <ColumnDefinition Width="150" />
                            <ColumnDefinition Width="50*" />
                        </Grid.ColumnDefinitions>

                        <Border Width="40"
                                Height="40"
                                BorderBrush="White"
                                BorderThickness="0.6"
                                CornerRadius="25">
                            <Border.Background>
                                <ImageBrush ImageSource="{Binding Avatar}" />
                            </Border.Background>
                        </Border>
                        <Border Width="10"
                                Height="10"
                                Margin="5"
                                HorizontalAlignment="Right"
                                VerticalAlignment="Bottom"
                                Background="LightGreen"
                                CornerRadius="15" />

                        <StackPanel Grid.Column="1">
                            <TextBlock Margin="10,0"
                                       Text="{Binding SendName}"
                                       TextTrimming="CharacterEllipsis" />
                            <TextBlock Margin="10,0"
                                       FontSize="11"
                                       Opacity="0.6"
                                       Text="{Binding RecentMsg}"
                                       TextTrimming="CharacterEllipsis" />
                        </StackPanel>

                        <Border Grid.Column="2"
                                Width="20"
                                Height="20"
                                Margin="5"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Background="White"
                                CornerRadius="15">
                            <TextBlock HorizontalAlignment="Center"
                                       VerticalAlignment="Center"
                                       FontSize="11"
                                       Foreground="{StaticResource MaterialDesignShadowBrush}"
                                       Text="{Binding UnreadMsgCount}" />
                        </Border>
                    </Grid>
                </DataTemplate>
            </ListView.ItemTemplate>
        </ListView>
    </Grid>
</UserControl>
